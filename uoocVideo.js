!function(){app.constant("videoConfig",{controlBar:{children:["progressControl","playToggle","volumeMenuButton","remainingTimeDisplay","durationDisplay","currentTimeDisplay","playbackRateMenuButton","fullscreenToggle","videoSource","trackSource"]},currentTime:!0,uoocPlayer:!0,srclang:"zh",preload:"auto",loop:!1,autoplay:!1,controls:!0,bigPlayButton:!0,playbackRates:[.8,1,1.2,1.5,1.99,2],techOrder:["html5","flash"]}),app.directive("uoocVideo",["videoService","videoConfig","$filter","$timeout",function(o,e,i,n){return{restrict:"AE",scope:{options:"="},link:function(n,t,r){if(!angular.isDefined(r.options))throw new Error("uoocVideo指令, 必须设置options属性");var s,a,u=angular.element(t);angular.isDefined(r.options)?n.options:{};n.newPlayer=function(){if(n.options){var t=i("formatCDNSource")(n.options.vsource),c=n.options.tsource||[],p=angular.extend({fontsize:r.fsize||null},n.options.config,e,{controlBar:{videoSource:t.list,trackSource:c}});if(u.html(""),s=u.append('<video id="player" class="video-js vjs-default-skin" srclang="zh"></video>').find("video")[0],a=videojs(s,p),t.count<1&&n.options.uri){var l={type:"video/mp4",src:i("escapeURL")(n.options.uri)};a.src(l),o.addSubtitle(a,c,r.fsize)}a.on("ready",function(){var e=n.options.finished?0:n.options.video_pos;setTimeout(function(){a.currentTime(e||0)},400),n.$emit("playerInit",a,n.options),o.resize(a,n.options.width,n.options.height),o.setBlurPause(a)}),a.on("timeupdate",function(){n.options.currentTime=a.currentTime(),n.$apply()}),a.on("useractive",function(){$(a.el).find(".vjs-caption").css({bottom:"60px"})}),a.on("userinactive",function(){$(a.el).find(".vjs-caption").css({bottom:"10px"})})}},n.$watchGroup(["options.vsource","options.uri"],function(){n.options.unwatchvideo||n.newPlayer()}),n.$on("newPlayer",function(o,e){n.options=e,n.newPlayer()}),n.$on("stopAllPlayer",function(){a.pause()}),n.$on("resize",function(e,i){o.resize(a,i.width,i.height)})}}}])}();